# FragDockRL

Fragment-based docking with reinforcement learning.

Licensed under a Custom Non-Commercial License. Commercial use requires permission.

**FragDockRL: A Reinforcement Learning Framework for Fragment-Based Ligand Design via Building Block Assembly and Tethered Docking**  
Author: Seung Hwan Hong et al.
Status: Preprint on bioRxiv (https://www.biorxiv.org/content/10.1101/2025.08.12.670002v1)


## Overview

FragDockRL is a reinforcement learning framework designed for **fragment-based ligand design**.  
It combines **building block assembly** with **tethered docking** to efficiently explore chemical space and optimize ligand binding poses.


## Installation

### Using conda (recommended)
conda env create -f environment.yml

conda activate fragdockrl_env


### Using pip
```bash```

pip install git+https://github.com/novelism/fragdockrl.git


## Data Preparation
See data/README.md

## Usage

The main scripts for running FragDockRL are located in the `scripts/` folder:

- `run_frag_dock_rl.ipynb`  
- `run_frag_dock_rl.py`

Both scripts have the same functionality. To run them, copy your chosen script to your working directory and modify the options inside before execution.

For detailed examples, please refer to the example projects provided under the `examples/` folder.

### Main options to modify:

- `ligand_pdb_file`: Path to your ligand PDB file.  
- `data_dir`: Path to the directory containing your prepared data files.  
- Inside the `params_dict` dictionary, update the following parameters as needed:
  - `'start_smi'`: SMILES code of the starting building block (e.g., `'NCc1ccncc1'`).  
  - `'smi_ref_com'`: Core SMILES code to be used as reference (e.g., `'Cc1ccncc1'`).  
  - `'ref_atom_idx_ref'`: Index of the atom in the core SMILES whose coordinates will be fixed during docking (starting from 0). Note this corresponds to the rotamer unit in the PDBQT, not an individual atom.  
  - `'num_sub_proc'`: Number of subprocesses for parallel computation used in docking (e.g., `16`).

## Steps to Run

1. Prepare your building block data as described in the **Data Preparation** section.  
2. Copy one of the main scripts (`run_frag_dock_rl.ipynb` or `run_frag_dock_rl.py`) from the `scripts/` folder to your working directory.  
3. Modify the script's options according to your system and target:
   - Set the correct `ligand_pdb_file` path.  
   - Adjust the parameters in `params_dict` as needed.  
4. Run the script to start the fragment-based ligand design process using reinforcement learning and tethered docking.  
5. Analyze the output results generated by the program.


